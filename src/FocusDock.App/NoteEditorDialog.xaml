<Window x:Class="FocusDock.App.NoteEditorDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Note Editor" 
        Width="900" Height="700"
        Background="#0F0F10"
        Foreground="#E8EAED"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize"
        MinWidth="700" MinHeight="600">
    
    <Window.Resources>
        <SolidColorBrush x:Key="AccentBrush" Color="#7B5FFF"/>
        <SolidColorBrush x:Key="DarkBg2" Color="#1C1C1F"/>
        <SolidColorBrush x:Key="DarkBg3" Color="#1D1E20"/>
        <SolidColorBrush x:Key="StrokeBrush" Color="#3F4550"/>
        <SolidColorBrush x:Key="TextPrimary" Color="#E8EAED"/>
        <SolidColorBrush x:Key="TextSecondary" Color="#AAB2BE"/>
        <SolidColorBrush x:Key="StatusInfoBrush" Color="#272B36"/>
        <SolidColorBrush x:Key="StatusErrorBrush" Color="#3B1F2B"/>
        
        <Style TargetType="TextBox">
            <Setter Property="Background" Value="{StaticResource DarkBg3}"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
            <Setter Property="BorderBrush" Value="{StaticResource StrokeBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="16,12"/>
            <Setter Property="FontSize" Value="15"/>
            <Setter Property="CaretBrush" Value="{StaticResource AccentBrush}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="8">
                            <ScrollViewer x:Name="PART_ContentHost" 
                                        Margin="{TemplateBinding Padding}"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <Style TargetType="Label">
            <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Margin" Value="0,0,0,6"/>
        </Style>
        
        <!-- Toolbar Button Style -->
        <Style x:Key="ToolbarButton" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource DarkBg3}"/>
            <Setter Property="Foreground" Value="{StaticResource TextSecondary}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Width" Value="36"/>
            <Setter Property="Height" Value="36"/>
            <Setter Property="Margin" Value="0,0,4,0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="6">
                            <ContentPresenter HorizontalAlignment="Center" 
                                            VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="{StaticResource AccentBrush}"/>
                    <Setter Property="Foreground" Value="White"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>
    
    <Grid Margin="24">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>   <!-- Header (Back, Title, Tags, Save) -->
            <RowDefinition Height="Auto"/>   <!-- Toolbar -->
            <RowDefinition Height="*"/>      <!-- Content -->
        </Grid.RowDefinitions>
        
        <!-- Title Field at Top -->
        <!-- Header: back, centered title, tags + save on right -->
        <Grid Grid.Row="0" x:Name="HeaderGrid" Margin="0,0,0,8">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Back to notes -->
            <Button Grid.Column="0"
                    Content="← All Notes"
                    Padding="10,6"
                    Margin="0,0,12,0"
                    Background="Transparent"
                    Foreground="{StaticResource TextSecondary}"
                    BorderThickness="0"
                    Cursor="Hand"
                    Click="OnBackClick"/>

            <!-- Center title -->
            <TextBox x:Name="TxtTitle"
                     Grid.Column="1"
                     HorizontalAlignment="Center"
                     Width="480"
                     FontSize="22"
                     FontWeight="SemiBold"
                     Background="Transparent"
                     Foreground="{StaticResource TextPrimary}"
                     BorderBrush="{StaticResource StrokeBrush}"
                     BorderThickness="0,0,0,1"
                     Padding="4,6,4,10"
                     Text="Untitled Note"
                     CaretBrush="{StaticResource AccentBrush}"/>

            <!-- Right: Tags + Save -->
            <StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Right">
                <TextBox x:Name="TxtTags" 
                         Width="180"
                         FontSize="13"
                         Padding="10,6"
                         Margin="0,0,10,0"
                         Background="{StaticResource DarkBg3}"
                         Foreground="{StaticResource TextPrimary}"
                         BorderBrush="{StaticResource StrokeBrush}"
                         BorderThickness="1"
                         CaretBrush="{StaticResource AccentBrush}"
                         ToolTip="Comma-separated tags"/>
                <Button x:Name="BtnSave"
                        Content="Update Note"
                        Padding="16,8"
                        Foreground="White"
                        BorderThickness="0"
                        Cursor="Hand"
                        Click="OnSaveClick">
                    <Button.Template>
                        <ControlTemplate TargetType="Button">
                            <Border CornerRadius="10" Padding="16,8">
                                <Border.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                        <GradientStop Color="#7B5FFF" Offset="0"/>
                                        <GradientStop Color="#A277FF" Offset="1"/>
                                    </LinearGradientBrush>
                                </Border.Background>
                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                        </ControlTemplate>
                    </Button.Template>
                </Button>
            </StackPanel>
        </Grid>
        
        <!-- Formatting Toolbar -->
    <Border Grid.Row="1" x:Name="ToolbarBorder"
        Background="{StaticResource DarkBg2}"
        BorderBrush="{StaticResource StrokeBrush}"
        BorderThickness="1"
        CornerRadius="12"
        Padding="14,10"
        Margin="0,0,0,12">
            <ScrollViewer HorizontalScrollBarVisibility="Auto" 
                          VerticalScrollBarVisibility="Disabled">
                <StackPanel Orientation="Horizontal">
                    <!-- Text Formatting -->
                    <Button Content="B" 
                            Style="{StaticResource ToolbarButton}"
                            FontWeight="Bold"
                            ToolTip="Bold"
                            Click="OnBoldClick"/>
                    <Button Content="I" 
                            Style="{StaticResource ToolbarButton}"
                            FontStyle="Italic"
                            ToolTip="Italic"
                            Click="OnItalicClick"/>
                    <Button Style="{StaticResource ToolbarButton}"
                            ToolTip="Underline"
                            Click="OnUnderlineClick">
                        <Button.Content>
                            <TextBlock Text="U" TextDecorations="Underline"/>
                        </Button.Content>
                    </Button>
                    
                    <Border Width="1" 
                            Height="24" 
                            Background="{StaticResource StrokeBrush}" 
                            Margin="8,0"/>
                    
                    <!-- Lists -->
                    <Button Content="• List" 
                            Style="{StaticResource ToolbarButton}"
                            Width="60"
                            ToolTip="Bullet List"
                            Click="OnBulletListClick"/>
                    <Button Content="1. List" 
                            Style="{StaticResource ToolbarButton}"
                            Width="60"
                            ToolTip="Numbered List"
                            Click="OnNumberedListClick"/>
                    <Button Content="☑ Task" 
                            Style="{StaticResource ToolbarButton}"
                            Width="60"
                            ToolTip="Task List"
                            Click="OnTaskListClick"/>
                    
                    <Border Width="1" 
                            Height="24" 
                            Background="{StaticResource StrokeBrush}" 
                            Margin="8,0"/>
                    
                    <!-- Headings -->
                    <Button Content="H1" 
                            Style="{StaticResource ToolbarButton}"
                            Width="40"
                            ToolTip="Heading 1"
                            Click="OnHeading1Click"/>
                    <Button Content="H2" 
                            Style="{StaticResource ToolbarButton}"
                            Width="40"
                            ToolTip="Heading 2"
                            Click="OnHeading2Click"/>
                    <Button Content="H3" 
                            Style="{StaticResource ToolbarButton}"
                            Width="40"
                            ToolTip="Heading 3"
                            Click="OnHeading3Click"/>
                    
                    <Border Width="1" 
                            Height="24" 
                            Background="{StaticResource StrokeBrush}" 
                            Margin="8,0"/>
                    
                    <!-- Other -->
                    <Button Content="—" 
                            Style="{StaticResource ToolbarButton}"
                            Width="40"
                            ToolTip="Horizontal Line"
                            Click="OnHorizontalLineClick"/>
                    <Button Content="&quot;&quot;" 
                            Style="{StaticResource ToolbarButton}"
                            Width="40"
                            ToolTip="Quote"
                            Click="OnQuoteClick"/>
                    <Button Style="{StaticResource ToolbarButton}"
                            Width="40"
                            ToolTip="Code Block"
                            Click="OnCodeBlockClick">
                        <Button.Content>
                            <TextBlock Text="{}{}" FontFamily="Consolas"/>
                        </Button.Content>
                    </Button>
                    
                    <Border Width="1" 
                            Height="24" 
                            Background="{StaticResource StrokeBrush}" 
                            Margin="8,0"/>
                    
            <!-- Bookmark Features + Focus Mode -->
                    <Button Content="🔖" 
                            Style="{StaticResource ToolbarButton}"
                            Width="40"
                            ToolTip="Add Bookmark Here"
                            Click="OnAddBookmarkClick"/>
                    <Button Content="📑" 
                            Style="{StaticResource ToolbarButton}"
                            Width="40"
                            ToolTip="Show Bookmarks"
                            Click="OnShowBookmarksClick"/>
            <Button Content="⤢" 
                Style="{StaticResource ToolbarButton}"
                Width="40"
                ToolTip="Toggle Focus Mode (F11)"
                Click="OnToggleFocusMode"/>
                </StackPanel>
            </ScrollViewer>
        </Border>
        
        <!-- Document Surface -->
        <Border x:Name="EditorSurface"
                Grid.Row="2"
                Background="{StaticResource DarkBg3}"
                BorderBrush="{StaticResource StrokeBrush}"
                BorderThickness="1"
                CornerRadius="14"
                Padding="28"
                Margin="0,18,0,18"
                SnapsToDevicePixels="True">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <TextBox x:Name="TxtContent" 
                         Grid.Row="0"
                         TextWrapping="Wrap" 
                         AcceptsReturn="True"
                         VerticalScrollBarVisibility="Auto"
                         Background="Transparent"
                         BorderThickness="0"
                         Padding="0"
                         FontSize="16"
                         Foreground="{StaticResource TextPrimary}"
                         CaretBrush="{StaticResource AccentBrush}"
                         MinHeight="320"
                         SpellCheck.IsEnabled="True"/>

                <Grid Grid.Row="1" Margin="0,20,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBlock Text="💡"
                                   FontSize="12"
                                   Margin="0,0,8,0"
                                   Foreground="{StaticResource TextSecondary}"/>
                        <TextBlock Text="Use Ctrl+B for bold, Ctrl+I for italic"
                                   FontSize="12"
                                   Foreground="{StaticResource TextSecondary}"/>
                    </StackPanel>

                    <Border Grid.Column="1"
                            x:Name="StatusChip"
                            Background="{StaticResource StatusInfoBrush}"
                            CornerRadius="12"
                            Padding="14,6"
                            Margin="20,0"
                            HorizontalAlignment="Center"
                            Visibility="Collapsed"
                            Opacity="0">
                        <TextBlock x:Name="StatusMessage"
                                   FontSize="12"
                                   Foreground="{StaticResource TextPrimary}"/>
                    </Border>

                    <TextBlock Grid.Column="2"
                               x:Name="TxtCharCount" 
                               Text="0 characters" 
                               FontSize="12"
                               Foreground="{StaticResource TextSecondary}"
                               VerticalAlignment="Center"/>
                </Grid>
            </Grid>
        </Border>
        
    <!-- Bookmarks Sidebar (overlay) -->
    <Border x:Name="BookmarksSidebar"
        Grid.Row="2"
        Width="0"
        Background="{StaticResource DarkBg2}"
        BorderBrush="{StaticResource StrokeBrush}"
        BorderThickness="1"
        CornerRadius="12"
        Margin="0,18,0,18"
        HorizontalAlignment="Right"
        SnapsToDevicePixels="True"
        Panel.ZIndex="10">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <!-- Header -->
                <Border Grid.Row="0" 
                        Background="{StaticResource DarkBg3}"
                        Padding="20,16"
                        BorderBrush="{StaticResource StrokeBrush}"
                        BorderThickness="0,0,0,1"
                        CornerRadius="12,12,0,0">
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBlock Text="📑" FontSize="16" Margin="0,0,8,0"/>
                        <TextBlock Text="Bookmarks" 
                                   FontSize="15"
                                   FontWeight="SemiBold"
                                   Foreground="{StaticResource TextPrimary}"/>
                    </StackPanel>
                </Border>
                
                <!-- Bookmarks List -->
                <ScrollViewer Grid.Row="1" 
                              VerticalScrollBarVisibility="Auto"
                              Padding="18,16,18,18">
                    <StackPanel x:Name="BookmarksList">
                        <TextBlock Text="No bookmarks yet"
                                   FontSize="12"
                                   Foreground="{StaticResource TextSecondary}"
                                   TextAlignment="Center"
                                   Margin="0,20"/>
                    </StackPanel>
                </ScrollViewer>
            </Grid>
        </Border>
        
        <!-- Footer removed: Save is now in header for maximum space -->
    </Grid>
</Window>
