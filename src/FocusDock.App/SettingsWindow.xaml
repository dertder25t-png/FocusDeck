<Window x:Class="FocusDock.App.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="FocusDeck Settings" Width="700" Height="740"
        Background="#26282D" Foreground="#E8EAED"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResize">
    <Grid>
        <Grid.Resources>
            <SolidColorBrush x:Key="AccentBrush" Color="#7C5CFF"/>
            <SolidColorBrush x:Key="PanelBrush" Color="#2F333B"/>
            <SolidColorBrush x:Key="InputBrush" Color="#3A3F4B"/>
            <SolidColorBrush x:Key="StrokeBrush" Color="#3F4550"/>

            <Style TargetType="TextBox">
                <Setter Property="Background" Value="{StaticResource InputBrush}"/>
                <Setter Property="BorderBrush" Value="{StaticResource StrokeBrush}"/>
                <Setter Property="Padding" Value="10"/>
                <Setter Property="Margin" Value="0,0,0,10"/>
            </Style>
            <Style TargetType="PasswordBox">
                <Setter Property="Background" Value="{StaticResource InputBrush}"/>
                <Setter Property="BorderBrush" Value="{StaticResource StrokeBrush}"/>
                <Setter Property="Padding" Value="10"/>
                <Setter Property="Margin" Value="0,0,0,10"/>
            </Style>

            <Style TargetType="Button" x:Key="PrimaryButton">
                <Setter Property="Background" Value="{StaticResource AccentBrush}"/>
                <Setter Property="Foreground" Value="White"/>
                <Setter Property="Padding" Value="10"/>
                <Setter Property="BorderBrush" Value="Transparent"/>
                <Setter Property="Cursor" Value="Hand"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Border Background="{TemplateBinding Background}" CornerRadius="8">
                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Opacity" Value="0.95"/>
                                </Trigger>
                                <Trigger Property="IsPressed" Value="True">
                                    <Setter Property="Opacity" Value="0.9"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </Grid.Resources>

        <Border Background="{StaticResource PanelBrush}" CornerRadius="12" Padding="16" BorderBrush="{StaticResource StrokeBrush}" BorderThickness="1">
            <TabControl Background="{StaticResource PanelBrush}" BorderThickness="0">
                <!-- Sync Tab -->
                <TabItem Header="Sync" Foreground="#E8EAED" Background="{StaticResource PanelBrush}">
                    <ScrollViewer>
                        <StackPanel Margin="8,12,8,12">
                            <TextBlock FontSize="16" FontWeight="Bold" Margin="0,0,0,12">Server Sync Setup</TextBlock>

                            <TextBlock Margin="0,0,0,4">Server URL</TextBlock>
                            <TextBox x:Name="TxtServerUrl" />
                            <TextBlock FontSize="11" Foreground="#AAB2BE" Margin="0,0,0,10">Example: https://my-focusdeck-server.com</TextBlock>
                            
                            <TextBlock Margin="0,8,0,4">Auth Token (JWT)</TextBlock>
                            <PasswordBox x:Name="PwdJwtToken" />
                            <TextBlock FontSize="11" Foreground="#AAB2BE" Margin="0,0,0,10">Paste a valid JWT token if your server requires authentication</TextBlock>
                            
                            <Button x:Name="BtnSaveSyncSettings" Content="Save Sync Settings" Style="{StaticResource PrimaryButton}" Click="OnSaveClick" />

                            <Separator Background="{StaticResource StrokeBrush}" Margin="0,16,0,16" />

                            <TextBlock FontSize="16" FontWeight="Bold" Margin="0,0,0,12">Devices</TextBlock>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,0,0,8" >
                                <Button x:Name="BtnRefreshDevices" Content="Refresh" Style="{StaticResource PrimaryButton}" Click="OnRefreshDevicesClick" />
                            </StackPanel>
                            <ListView x:Name="LstDevices" Height="180" BorderBrush="{StaticResource StrokeBrush}" BorderThickness="1">
                                <ListView.View>
                                    <GridView>
                                        <GridViewColumn Header="Name" DisplayMemberBinding="{Binding DeviceName}" Width="160"/>
                                        <GridViewColumn Header="Platform" DisplayMemberBinding="{Binding Platform}" Width="100"/>
                                        <GridViewColumn Header="DeviceId" DisplayMemberBinding="{Binding DeviceId}" Width="220"/>
                                        <GridViewColumn Header="Last Sync" DisplayMemberBinding="{Binding LastSyncAt}" Width="140"/>
                                    </GridView>
                                </ListView.View>
                            </ListView>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,8,0,0">
                                <Button x:Name="BtnUnregisterDevice" Content="Unregister Selected" Style="{StaticResource PrimaryButton}" Click="OnUnregisterDeviceClick" />
                            </StackPanel>
                        </StackPanel>
                    </ScrollViewer>
                </TabItem>
                
                <!-- Calendar Tab -->
                <TabItem Header="Calendar" Foreground="#E8EAED" Background="{StaticResource PanelBrush}">
                    <ScrollViewer>
                        <StackPanel Margin="8,12,8,12">
                            <TextBlock FontSize="16" FontWeight="Bold" Margin="0,0,0,12">Google Calendar Setup</TextBlock>

                            <TextBlock Margin="0,0,0,4">Client ID</TextBlock>
                            <TextBox x:Name="TxtGoogleClientId" />

                            <TextBlock Margin="0,4,0,4">Client Secret</TextBlock>
                            <PasswordBox x:Name="PwdGoogleClientSecret" />

                            <CheckBox x:Name="ChkEnableGoogle" Content="Enable Google Calendar Sync" Margin="0,8,0,12" />

                            <Button x:Name="BtnGoogleAuth" Content="Authorize with Google" Style="{StaticResource PrimaryButton}" Click="OnGoogleAuthClick" Margin="0,0,0,16" />

                            <Separator Background="{StaticResource StrokeBrush}" Margin="0,0,0,16" />

                            <TextBlock FontSize="16" FontWeight="Bold" Margin="0,0,0,12">Canvas Setup</TextBlock>

                            <TextBlock Margin="0,0,0,4">Canvas Instance URL</TextBlock>
                            <TextBox x:Name="TxtCanvasUrl" Text="https://canvas.instructure.com" Margin="0,0,0,4" />
                            <TextBlock FontSize="11" Foreground="#AAB2BE" Margin="0,0,0,10">Example: https://myschool.instructure.com</TextBlock>

                            <TextBlock Margin="0,0,0,4">API Token</TextBlock>
                            <PasswordBox x:Name="PwdCanvasToken" />

                            <CheckBox x:Name="ChkEnableCanvas" Content="Enable Canvas Sync" Margin="0,8,0,12" />

                            <Button x:Name="BtnCanvasTest" Content="Test Connection" Style="{StaticResource PrimaryButton}" Click="OnCanvasTestClick" Margin="0,0,0,10" />

                            <TextBlock x:Name="TxtCanvasStatus" FontSize="12" TextWrapping="Wrap" Margin="0,0,0,16" />

                            <Separator Background="{StaticResource StrokeBrush}" Margin="0,0,0,16" />

                            <TextBlock Margin="0,0,0,4">Sync Interval (minutes)</TextBlock>
                            <Slider x:Name="SliderSyncInterval" Minimum="5" Maximum="120" Value="15" Margin="0,0,0,4" />
                            <TextBlock x:Name="TxtSyncInterval" Margin="0,0,0,16">15 minutes</TextBlock>

                            <Button x:Name="BtnSaveSettings" Content="Save Settings" Style="{StaticResource PrimaryButton}" Click="OnSaveClick" />
                        </StackPanel>
                    </ScrollViewer>
                </TabItem>

                <!-- Tasks Tab -->
                <TabItem Header="Tasks" Foreground="#E8EAED" Background="{StaticResource PanelBrush}">
                    <StackPanel Margin="8,12,8,12">
                        <TextBlock FontSize="16" FontWeight="Bold" Margin="0,0,0,15">Task Settings</TextBlock>
                        <CheckBox Content="Auto-import Canvas assignments as tasks" Margin="0,0,0,10" />
                        <CheckBox Content="Show completed tasks" Margin="0,0,0,10" />
                        <CheckBox Content="Group tasks by course" Margin="0,0,0,20" />

                        <Separator Background="{StaticResource StrokeBrush}" Margin="0,0,0,20" />

                        <TextBlock FontSize="14" FontWeight="Bold" Margin="0,0,0,10">About</TextBlock>
                        <TextBlock TextWrapping="Wrap" Foreground="#AAB2BE">
                            For setup instructions, see API_SETUP_GUIDE.md in the FocusDeck folder.
                        </TextBlock>
                    </StackPanel>
                </TabItem>

                <!-- Study Tab -->
                <TabItem Header="Study" Foreground="#E8EAED" Background="{StaticResource PanelBrush}">
                    <StackPanel Margin="8,12,8,12">
                        <TextBlock FontSize="16" FontWeight="Bold" Margin="0,0,0,15">Study Session Settings</TextBlock>
                        <CheckBox Content="Auto-start sessions before due dates" Margin="0,0,0,10" />
                        <CheckBox Content="Show effectiveness rating after session" IsChecked="True" Margin="0,0,0,20" />

                        <TextBlock Margin="0,0,0,4">Session Duration (minutes)</TextBlock>
                        <Slider Minimum="15" Maximum="180" Value="60" />
                    </StackPanel>
                </TabItem>

                <!-- Dock Position Tab -->
                <TabItem Header="Dock Position" Foreground="#E8EAED" Background="{StaticResource PanelBrush}">
                    <StackPanel Margin="8,12,8,12">
                        <TextBlock FontSize="16" FontWeight="Bold" Margin="0,0,0,15">Dock Position Settings</TextBlock>
                        
                        <TextBlock Margin="0,0,0,8">Horizontal Alignment</TextBlock>
                        <TextBlock FontSize="12" Foreground="#AAB2BE" TextWrapping="Wrap" Margin="0,0,0,8">
                            Choose where the dock appears on your screen horizontally.
                        </TextBlock>
                        
                        <StackPanel Margin="0,0,0,20">
                            <RadioButton x:Name="RbAlignLeft" Content="Left" Margin="0,0,0,8" 
                                         Foreground="#E8EAED" GroupName="Alignment"/>
                            <RadioButton x:Name="RbAlignCenter" Content="Center (Default)" Margin="0,0,0,8" 
                                         Foreground="#E8EAED" GroupName="Alignment" IsChecked="True"/>
                            <RadioButton x:Name="RbAlignRight" Content="Right" Margin="0,0,0,8" 
                                         Foreground="#E8EAED" GroupName="Alignment"/>
                        </StackPanel>

                        <Separator Background="{StaticResource StrokeBrush}" Margin="0,0,0,20" />

                        <TextBlock FontSize="14" FontWeight="Bold" Margin="0,0,0,10">Preview</TextBlock>
                        <Border Background="{StaticResource InputBrush}" 
                                BorderBrush="{StaticResource StrokeBrush}" 
                                BorderThickness="1" 
                                CornerRadius="8" 
                                Height="60" 
                                Margin="0,0,0,20">
                            <Grid>
                                <!-- Screen representation -->
                                <Border x:Name="PreviewDock" 
                                        Width="150" 
                                        Height="30" 
                                        Background="{StaticResource AccentBrush}" 
                                        CornerRadius="15" 
                                        VerticalAlignment="Center"
                                        HorizontalAlignment="Center">
                                    <TextBlock Text="Dock" 
                                               FontSize="10" 
                                               HorizontalAlignment="Center" 
                                               VerticalAlignment="Center" 
                                               Foreground="White"/>
                                </Border>
                            </Grid>
                        </Border>

                        <Button x:Name="BtnApplyPosition" 
                                Content="Apply Position" 
                                Style="{StaticResource PrimaryButton}" 
                                Click="OnApplyPositionClick" 
                                Margin="0,0,0,10" />
                        
                        <TextBlock FontSize="11" Foreground="#AAB2BE" TextWrapping="Wrap">
                            Changes will take effect immediately. The dock width automatically adjusts based on the number of open windows.
                        </TextBlock>
                    </StackPanel>
                </TabItem>

                <!-- About Tab -->
                <TabItem Header="About" Foreground="#E8EAED" Background="{StaticResource PanelBrush}">
                    <StackPanel Margin="8,12,8,12">
                        <TextBlock FontSize="18" FontWeight="Bold" Margin="0,0,0,5">FocusDeck</TextBlock>
                        <TextBlock FontSize="12" Foreground="#AAB2BE" Margin="0,0,0,16">Study Productivity Platform</TextBlock>

                        <Separator Background="{StaticResource StrokeBrush}" Margin="0,0,0,16" />

                        <TextBlock FontSize="12" TextWrapping="Wrap" Margin="0,0,0,5">
                            <Run FontWeight="Bold">Version:</Run> Phase 3 (Beta)
                        </TextBlock>
                        <TextBlock FontSize="12" TextWrapping="Wrap" Margin="0,0,0,16">
                            <Run FontWeight="Bold">Features:</Run> Window Management • Calendar Integration • Task Tracking • Study Planning
                        </TextBlock>

                        <Separator Background="{StaticResource StrokeBrush}" Margin="0,0,0,16" />

                        <TextBlock FontSize="12" FontWeight="Bold" Margin="0,0,0,10">Resources</TextBlock>
                        <Button Content="View Setup Guide" Style="{StaticResource PrimaryButton}" Margin="0,0,0,10" />
                        <Button Content="GitHub Repository" Style="{StaticResource PrimaryButton}" />
                    </StackPanel>
                </TabItem>
            </TabControl>
        </Border>
    </Grid>
</Window>
