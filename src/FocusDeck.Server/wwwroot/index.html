<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FocusDeck - Web App</title>
    <link rel="stylesheet" href="styles.css?v=1.1.0">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-spinner"></div>
        <div class="loading-text">Loading FocusDeck...</div>
    </div>

    <!-- Main Container -->
    <div id="app" class="app-container" style="display: none;">
        <!-- Sidebar Navigation -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <div class="logo-icon">🎯</div>
                    <span class="logo-text">FocusDeck</span>
                </div>
                <div class="status-indicator online" title="Server Online"></div>
            </div>

            <nav class="nav-menu">
                <button class="nav-item active" data-view="dashboard">
                    <span class="nav-icon">📊</span>
                    <span class="nav-label">Dashboard</span>
                </button>
                <button class="nav-item" data-view="planner">
                    <span class="nav-icon">📅</span>
                    <span class="nav-label">My Day</span>
                </button>
                <button class="nav-item" data-view="timer">
                    <span class="nav-icon">⏱️</span>
                    <span class="nav-label">Study Timer</span>
                </button>
                <button class="nav-item" data-view="decks">
                    <span class="nav-icon">🗂️</span>
                    <span class="nav-label">Decks</span>
                </button>
                <button class="nav-item" data-view="analytics">
                    <span class="nav-icon">📈</span>
                    <span class="nav-label">Analytics</span>
                </button>
                <button class="nav-item" data-view="calendar">
                    <span class="nav-icon">📆</span>
                    <span class="nav-label">Calendar</span>
                </button>
                <button class="nav-item" data-view="automations">
                    <span class="nav-icon">🤖</span>
                    <span class="nav-label">Automations</span>
                </button>
                <button class="nav-item" data-view="settings">
                    <span class="nav-icon">⚙️</span>
                    <span class="nav-label">Settings</span>
                </button>
            </nav>

            <div class="sidebar-footer">
                <div class="quick-stats">
                    <div class="stat-item">
                        <div class="stat-value" id="sidebarActiveTasks">2</div>
                        <div class="stat-label">Active Tasks</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="sidebarCompletedToday">0</div>
                        <div class="stat-label">Today</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value completion-rate" id="sidebarCompletionRate">0%</div>
                        <div class="stat-label">Rate</div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Dashboard View -->
            <div id="dashboardView" class="view active">
                <header class="view-header">
                    <h1 class="view-title">Dashboard</h1>
                    <div class="header-actions">
                        <div class="date-time">
                            <div id="currentDate" class="current-date"></div>
                            <div id="currentTime" class="current-time"></div>
                        </div>
                    </div>
                </header>

                <div class="dashboard-grid">
                    <!-- Quick Stats Cards -->
                    <div class="card stats-card">
                        <h2 class="card-title">Today's Overview</h2>
                        <div class="stats-grid">
                            <div class="stat-box">
                                <div class="stat-icon">✓</div>
                                <div class="stat-info">
                                    <div class="stat-number" id="dashCompletedTasks">0</div>
                                    <div class="stat-text">Completed</div>
                                </div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-icon">⏰</div>
                                <div class="stat-info">
                                    <div class="stat-number" id="dashStudyTime">0h</div>
                                    <div class="stat-text">Study Time</div>
                                </div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-icon">🔥</div>
                                <div class="stat-info">
                                    <div class="stat-number" id="dashStreak">0</div>
                                    <div class="stat-text">Streak</div>
                                </div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-icon">🎯</div>
                                <div class="stat-info">
                                    <div class="stat-number" id="dashProductivity">0%</div>
                                    <div class="stat-text">Focus</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="card quick-actions-card">
                        <h2 class="card-title">Quick Actions</h2>
                        <div class="quick-actions-grid">
                            <button class="quick-action-btn" data-action="start-timer">
                                <span class="qa-icon">▶</span>
                                <span class="qa-label">Start Timer</span>
                            </button>
                            <button class="quick-action-btn" data-action="add-task">
                                <span class="qa-icon">+</span>
                                <span class="qa-label">Add Task</span>
                            </button>
                            <button class="quick-action-btn" data-action="new-deck">
                                <span class="qa-icon">🗂️</span>
                                <span class="qa-label">New Deck</span>
                            </button>
                            <button class="quick-action-btn" data-action="view-calendar">
                                <span class="qa-icon">📅</span>
                                <span class="qa-label">Calendar</span>
                            </button>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="card activity-card">
                        <h2 class="card-title">Recent Activity</h2>
                        <div id="recentActivity" class="activity-list">
                            <div class="empty-state">
                                <div class="empty-icon">📝</div>
                                <p>No recent activity</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Planner View (My Day) -->
            <div id="plannerView" class="view">
                <header class="view-header">
                    <div>
                        <h1 class="view-title">My Day</h1>
                        <p class="view-subtitle" id="plannerSubtitle">Showing tasks for the next 7 days</p>
                    </div>
                    <div class="header-actions">
                        <button class="btn btn-secondary" id="categoriesBtn">
                            <span>📁</span> Categories
                        </button>
                        <button class="btn btn-secondary" id="sortBtn">
                            <span>⬇</span> Sort
                        </button>
                        <button class="btn btn-secondary" id="filterBtn">
                            <span>🔍</span> Filter
                        </button>
                        <button class="btn btn-primary" id="addTaskBtn">
                            <span>+</span> Add Task
                        </button>
                    </div>
                </header>

                <div class="planner-layout">
                    <!-- Task Input Area -->
                    <div class="task-input-area" id="taskInputArea" style="display: none;">
                        <div class="card">
                            <div class="task-form">
                                <input type="text" id="taskTitle" class="input-field" placeholder="Task title" autofocus />
                                <div class="form-row">
                                    <select id="taskCategory" class="select-field">
                                        <option value="">No Category</option>
                                        <option value="work">Work</option>
                                        <option value="study">Study</option>
                                        <option value="personal">Personal</option>
                                        <option value="urgent">Urgent</option>
                                    </select>
                                    <select id="taskPriority" class="select-field">
                                        <option value="low">Low Priority</option>
                                        <option value="medium" selected>Medium Priority</option>
                                        <option value="high">High Priority</option>
                                        <option value="urgent">Urgent</option>
                                    </select>
                                    <input type="date" id="taskDueDate" class="input-field" />
                                    <input type="time" id="taskDueTime" class="input-field" />
                                </div>
                                <textarea id="taskNotes" class="textarea-field" placeholder="Add notes..." rows="3"></textarea>
                                <div class="form-actions">
                                    <button class="btn btn-secondary" id="cancelTaskBtn">Cancel</button>
                                    <button class="btn btn-primary" id="saveTaskBtn">Save Task</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tasks Timeline -->
                    <div class="tasks-container">
                        <div id="tasksTimeline" class="tasks-timeline">
                            <!-- Sample task for UI preview -->
                            <div class="day-section">
                                <div class="day-header">
                                    <span class="day-label">Thu Oct 30 <span class="today-badge">Today</span></span>
                                    <span class="task-count">1 task</span>
                                </div>
                                <div class="tasks-list">
                                    <div class="task-item">
                                        <div class="task-checkbox">
                                            <input type="checkbox" id="task-sample" />
                                            <label for="task-sample"></label>
                                        </div>
                                        <div class="task-content">
                                            <div class="task-title-text">tests</div>
                                            <div class="task-badges">
                                                <span class="badge badge-today">today</span>
                                            </div>
                                        </div>
                                        <div class="task-actions">
                                            <button class="task-action-btn" title="Edit">
                                                <span>✏️</span>
                                            </button>
                                            <button class="task-action-btn delete" title="Delete">
                                                <span>🗑️</span>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Sidebar Stats in Planner -->
                    <aside class="planner-sidebar">
                        <div class="card">
                            <h3 class="card-title-small">QUICK STATS</h3>
                            <div class="sidebar-stats">
                                <div class="sidebar-stat">
                                    <div class="sidebar-stat-value active-color" id="plannerActiveTasks">2</div>
                                    <div class="sidebar-stat-label">Active Tasks</div>
                                </div>
                                <div class="sidebar-stat">
                                    <div class="sidebar-stat-value completed-color" id="plannerCompletedToday">0</div>
                                    <div class="sidebar-stat-label">Completed Today</div>
                                </div>
                                <div class="sidebar-stat">
                                    <div class="sidebar-stat-value completion-color" id="plannerCompletionRate">0%</div>
                                    <div class="sidebar-stat-label">Completion Rate</div>
                                </div>
                            </div>
                        </div>
                    </aside>
                </div>
            </div>

            <!-- Study Timer View -->
            <div id="timerView" class="view">
                <header class="view-header">
                    <h1 class="view-title">Study Timer</h1>
                </header>

                <div class="timer-layout">
                    <div class="timer-main">
                        <div class="card timer-card">
                            <div class="timer-display-wrapper">
                                <svg class="timer-circle" viewBox="0 0 200 200">
                                    <circle class="timer-circle-bg" cx="100" cy="100" r="85" />
                                    <circle class="timer-circle-progress" id="timerProgress" cx="100" cy="100" r="85" />
                                </svg>
                                <div class="timer-display" id="timerDisplay">25:00</div>
                                <div class="timer-label" id="timerLabel">Pomodoro</div>
                            </div>

                            <div class="timer-status" id="timerStatus">Ready to focus 🎯</div>

                            <div class="timer-controls">
                                <button class="btn btn-icon" id="timerResetBtn" title="Reset">
                                    <span>↻</span>
                                </button>
                                <button class="btn btn-primary btn-large" id="timerStartBtn">
                                    <span>▶</span> Start
                                </button>
                                <button class="btn btn-icon" id="timerSkipBtn" title="Skip">
                                    <span>⏭</span>
                                </button>
                            </div>

                            <div class="timer-presets">
                                <button class="preset-btn" data-minutes="15">15 min</button>
                                <button class="preset-btn active" data-minutes="25">25 min</button>
                                <button class="preset-btn" data-minutes="45">45 min</button>
                                <button class="preset-btn" data-minutes="60">60 min</button>
                            </div>

                            <div class="custom-time-input">
                                <input type="number" id="customMinutes" class="input-field-small" placeholder="Custom minutes" min="1" max="180" />
                                <button class="btn btn-secondary btn-small" id="setCustomTimeBtn">Set</button>
                            </div>

                            <div class="timer-session-notes">
                                <label class="form-label-small">Session Notes</label>
                                <textarea id="sessionNotes" class="textarea-field" placeholder="What are you working on?" rows="3"></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Session History Sidebar -->
                    <aside class="timer-sidebar">
                        <div class="card">
                            <h2 class="card-title-small">TODAY'S SESSIONS</h2>
                            <div id="sessionHistory" class="session-history">
                                <div class="empty-state-small">
                                    <div class="empty-icon-small">⏱️</div>
                                    <p>No sessions yet</p>
                                    <small>Start a timer to log your first session</small>
                                </div>
                            </div>
                        </div>

                        <div class="card mt-1">
                            <h2 class="card-title-small">STATISTICS</h2>
                            <div class="timer-stats">
                                <div class="timer-stat-item">
                                    <span class="timer-stat-label">Total Time</span>
                                    <span class="timer-stat-value" id="totalTimeToday">0h 0m</span>
                                </div>
                                <div class="timer-stat-item">
                                    <span class="timer-stat-label">Sessions</span>
                                    <span class="timer-stat-value" id="sessionsCount">0</span>
                                </div>
                                <div class="timer-stat-item">
                                    <span class="timer-stat-label">Average</span>
                                    <span class="timer-stat-value" id="avgSession">0m</span>
                                </div>
                            </div>
                        </div>
                    </aside>
                </div>
            </div>

            <!-- Decks View -->
            <div id="decksView" class="view">
                <header class="view-header">
                    <h1 class="view-title">Decks</h1>
                    <div class="header-actions">
                        <button class="btn btn-secondary" id="importDeckBtn">
                            <span>📥</span> Import
                        </button>
                        <button class="btn btn-secondary" id="exportDecksBtn">
                            <span>📤</span> Export
                        </button>
                        <button class="btn btn-primary" id="addDeckBtn">
                            <span>+</span> New Deck
                        </button>
                    </div>
                </header>

                <div class="decks-grid" id="decksGrid">
                    <div class="empty-state-large">
                        <div class="empty-icon-large">🗂️</div>
                        <h3>No Decks Yet</h3>
                        <p>Create your first deck to organize your study materials</p>
                        <button class="btn btn-primary mt-1" id="createFirstDeck">
                            <span>+</span> Create Deck
                        </button>
                    </div>
                </div>
            </div>

            <!-- Analytics View -->
            <div id="analyticsView" class="view">
                <header class="view-header">
                    <h1 class="view-title">Analytics</h1>
                    <div class="header-actions">
                        <select class="select-field" id="analyticsTimeRange">
                            <option value="7">Last 7 days</option>
                            <option value="30" selected>Last 30 days</option>
                            <option value="90">Last 90 days</option>
                        </select>
                        <button class="btn btn-secondary" id="refreshAnalyticsBtn">
                            <span>↻</span> Refresh
                        </button>
                    </div>
                </header>

                <div class="analytics-grid">
                    <div class="card analytics-overview">
                        <h2 class="card-title">Overview</h2>
                        <div class="analytics-overview-grid">
                            <div class="analytics-stat">
                                <div class="analytics-stat-icon">⏱️</div>
                                <div class="analytics-stat-content">
                                    <div class="analytics-stat-value" id="totalStudyTime">0h 0m</div>
                                    <div class="analytics-stat-label">Total Study Time</div>
                                </div>
                            </div>
                            <div class="analytics-stat">
                                <div class="analytics-stat-icon">✓</div>
                                <div class="analytics-stat-content">
                                    <div class="analytics-stat-value" id="totalTasksCompleted">0</div>
                                    <div class="analytics-stat-label">Tasks Completed</div>
                                </div>
                            </div>
                            <div class="analytics-stat">
                                <div class="analytics-stat-icon">📈</div>
                                <div class="analytics-stat-content">
                                    <div class="analytics-stat-value" id="productivityTrend">0%</div>
                                    <div class="analytics-stat-label">Productivity Trend</div>
                                </div>
                            </div>
                            <div class="analytics-stat">
                                <div class="analytics-stat-icon">⭐</div>
                                <div class="analytics-stat-content">
                                    <div class="analytics-stat-value" id="averageRating">0.0</div>
                                    <div class="analytics-stat-label">Avg Effectiveness</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <h2 class="card-title">Study Time Trend</h2>
                        <div class="chart-placeholder">
                            <div class="empty-icon">📊</div>
                            <p>Start studying to see your trends</p>
                        </div>
                    </div>

                    <div class="card">
                        <h2 class="card-title">Category Breakdown</h2>
                        <div class="chart-placeholder">
                            <div class="empty-icon">📈</div>
                            <p>Complete tasks to see breakdown</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Calendar View -->
            <div id="calendarView" class="view">
                <header class="view-header">
                    <div>
                        <h1 class="view-title">Calendar</h1>
                        <span class="calendar-month-year" id="calendarMonthYear"></span>
                    </div>
                    <div class="header-actions">
                        <button class="btn btn-secondary" id="calendarPrevBtn">‹ Prev</button>
                        <button class="btn btn-secondary" id="calendarTodayBtn">Today</button>
                        <button class="btn btn-secondary" id="calendarNextBtn">Next ›</button>
                    </div>
                </header>

                <div class="calendar-container">
                    <div class="calendar-grid" id="calendarGrid">
                        <!-- Calendar will be rendered here -->
                    </div>
                </div>
            </div>

            <!-- Automations View -->
            <div id="automationsView" class="view">
                <header class="view-header">
                    <h1 class="view-title">Automations</h1>
                    <div class="header-actions">
                        <button class="btn btn-primary" id="createAutomationBtn">
                            <span>+</span> Create Automation
                        </button>
                    </div>
                </header>

                <div class="automations-container">
                    <!-- Automation Statistics -->
                    <div class="card">
                        <h2 class="card-title">Automation Statistics</h2>
                        <div class="stats-grid">
                            <div class="stat-box">
                                <div class="stat-label">Total Automations</div>
                                <div class="stat-value" id="statsTotal Automations">0</div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-label">Enabled</div>
                                <div class="stat-value" id="statsEnabledAutomations" style="color: var(--success);">0</div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-label">Total Executions</div>
                                <div class="stat-value" id="statsTotalExecutions">0</div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-label">Success Rate</div>
                                <div class="stat-value" id="statsSuccessRate" style="color: var(--success);">0%</div>
                            </div>
                        </div>
                    </div>

                    <!-- Connected Services -->
                    <div class="card">
                        <h2 class="card-title">Connected Services</h2>
                        <p class="card-description">Manage your external service integrations</p>
                        <div id="connectedServicesList" class="services-grid">
                            <!-- Services will be loaded here -->
                        </div>
                        <div class="card-actions">
                            <button class="btn btn-secondary" id="connectServiceBtn">
                                <span>🔗</span> Connect New Service
                            </button>
                        </div>
                    </div>

                    <!-- Active Automations -->
                    <div class="card">
                        <h2 class="card-title">Your Automations</h2>
                        <p class="card-description">Manage your automated workflows</p>
                        <div id="automationsList" class="automations-list">
                            <!-- Automations will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings View -->
            <div id="settingsView" class="view">
                <header class="view-header">
                    <h1 class="view-title">Settings</h1>
                </header>

                <div class="settings-container">
                    <div class="settings-grid">
                        <div class="card">
                            <h2 class="card-title">Appearance</h2>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <label class="setting-label">Theme</label>
                                    <p class="setting-description">Choose your preferred color scheme</p>
                                </div>
                                <select class="select-field" id="themeSetting">
                                    <option value="dark" selected>Dark</option>
                                    <option value="light">Light</option>
                                    <option value="auto">Auto</option>
                                </select>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <label class="setting-label">Accent Color</label>
                                    <p class="setting-description">Primary accent color</p>
                                </div>
                                <select class="select-field" id="accentColorSetting">
                                    <option value="purple" selected>Purple</option>
                                    <option value="blue">Blue</option>
                                    <option value="green">Green</option>
                                    <option value="orange">Orange</option>
                                </select>
                            </div>
                        </div>

                        <div class="card">
                            <h2 class="card-title">Notifications</h2>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <label class="setting-label">Enable Notifications</label>
                                    <p class="setting-description">Receive timer and task reminders</p>
                                </div>
                                <label class="toggle">
                                    <input type="checkbox" id="notificationsSetting" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <label class="setting-label">Sound Effects</label>
                                    <p class="setting-description">Play sounds for timers and actions</p>
                                </div>
                                <label class="toggle">
                                    <input type="checkbox" id="soundSetting" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </div>

                        <div class="card">
                            <h2 class="card-title">Timer Settings</h2>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <label class="setting-label">Pomodoro Duration</label>
                                    <p class="setting-description">Default work session length (minutes)</p>
                                </div>
                                <input type="number" class="input-field-small" id="pomodoroDefault" value="25" min="1" max="60" />
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <label class="setting-label">Short Break</label>
                                    <p class="setting-description">Break duration (minutes)</p>
                                </div>
                                <input type="number" class="input-field-small" id="shortBreakDefault" value="5" min="1" max="30" />
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <label class="setting-label">Auto-start Breaks</label>
                                    <p class="setting-description">Automatically start break timers</p>
                                </div>
                                <label class="toggle">
                                    <input type="checkbox" id="autoStartBreaks">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </div>

                        <div class="card">
                            <h2 class="card-title">Server Management</h2>
                            <p class="card-description">Keep your server up to date with the latest features and fixes.</p>
                            
                            <div class="setting-item">
                                <div class="setting-info">
                                    <label class="setting-label">Current Version</label>
                                    <p class="setting-description" id="currentVersionInfo">Loading...</p>
                                </div>
                            </div>

                            <div class="setting-item" id="updateAvailableInfo" style="display: none;">
                                <div class="setting-info">
                                    <label class="setting-label">Update Available</label>
                                    <p class="setting-description" id="latestVersionInfo"></p>
                                </div>
                            </div>
                            
                            <div class="setting-actions">
                                <button class="btn btn-secondary" id="checkUpdatesBtn">
                                    <span>🔍</span> Check for Updates
                                </button>
                                <button class="btn btn-primary" id="updateServerBtn" style="display: none;">
                                    <span>🔄</span> Update Server Now
                                </button>
                            </div>
                            
                            <div id="updateStatusBox" style="display: none; margin-top: 1rem; padding: 1rem; background: var(--card-bg); border-radius: 8px; border-left: 4px solid var(--accent-color);">
                                <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                                    <div class="loading-spinner" style="width: 20px; height: 20px;"></div>
                                    <strong id="updateStatusTitle">Updating server...</strong>
                                </div>
                                <p id="updateStatusMessage" style="margin: 0; font-size: 0.9rem; color: var(--text-secondary);">This may take up to 60 seconds. The page will reload automatically.</p>
                            </div>
                            
                            <p class="card-footer-note">Updates pull the latest code from GitHub, rebuild, and restart the server automatically. The process takes about 30-60 seconds.</p>
                        </div>

                        <div class="card">
                            <h2 class="card-title">Data Management</h2>
                            <p class="card-description">Manage your local and server data</p>
                            <div class="setting-actions">
                                <button class="btn btn-secondary" id="clearCacheBtn">
                                    <span>🗑️</span> Clear Cache
                                </button>
                                <button class="btn btn-secondary" id="exportDataBtn">
                                    <span>📤</span> Export All Data
                                </button>
                                <button class="btn btn-danger" id="resetDataBtn">
                                    <span>⚠️</span> Reset All Data
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Automation Modal -->
    <div id="automationModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2 class="modal-title" id="automationModalTitle">Create Automation</h2>
                <button class="modal-close" id="closeAutomationModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Automation Name</label>
                    <input type="text" id="automationName" class="input-field" placeholder="e.g., Start timer when study event begins" />
                </div>

                <div class="form-section">
                    <h3 class="section-title">🎯 When This Happens... (Trigger)</h3>
                    <div class="form-group">
                        <label class="form-label">Service</label>
                        <select id="triggerService" class="select-field">
                            <option value="FocusDeck">🎯 FocusDeck</option>
                            <option value="GoogleCalendar">📅 Google Calendar</option>
                            <option value="Canvas">🎓 Canvas LMS</option>
                            <option value="HomeAssistant">🏠 Home Assistant</option>
                            <option value="Spotify">🎵 Spotify</option>
                            <option value="Notion">📓 Notion</option>
                            <option value="Todoist">✅ Todoist</option>
                            <option value="Slack">💬 Slack</option>
                            <option value="Discord">🎮 Discord</option>
                            <option value="PhilipsHue">💡 Philips Hue</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Trigger Type</label>
                        <select id="triggerType" class="select-field">
                            <!-- Options populated based on service -->
                        </select>
                    </div>
                    <div id="triggerSettings" class="form-settings">
                        <!-- Dynamic settings fields -->
                    </div>
                </div>

                <div class="form-section">
                    <h3 class="section-title">⚡ Do This... (Actions)</h3>
                    <div id="actionsList" class="actions-list">
                        <!-- Actions will be added here -->
                    </div>
                    <button class="btn btn-secondary" id="addActionBtn">
                        <span>+</span> Add Action
                    </button>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancelAutomationBtn">Cancel</button>
                <button class="btn btn-primary" id="saveAutomationBtn">Save Automation</button>
            </div>
        </div>
    </div>

    <!-- Connect Service Modal -->
    <div id="connectServiceModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Connect Service</h2>
                <button class="modal-close" id="closeConnectServiceModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="services-list">
                    <button class="service-card" data-service="GoogleCalendar">
                        <div class="service-icon">📅</div>
                        <div class="service-info">
                            <h3>Google Calendar</h3>
                            <p>Trigger automations based on calendar events</p>
                        </div>
                    </button>
                    <button class="service-card" data-service="Canvas">
                        <div class="service-icon">🎓</div>
                        <div class="service-info">
                            <h3>Canvas LMS</h3>
                            <p>Get notified about assignments and grades</p>
                        </div>
                    </button>
                    <button class="service-card" data-service="HomeAssistant">
                        <div class="service-icon">🏠</div>
                        <div class="service-info">
                            <h3>Home Assistant</h3>
                            <p>Control your smart home devices</p>
                        </div>
                    </button>
                    <button class="service-card" data-service="Spotify">
                        <div class="service-icon">🎵</div>
                        <div class="service-info">
                            <h3>Spotify</h3>
                            <p>Control music playback</p>
                        </div>
                    </button>
                    <button class="service-card" data-service="Notion">
                        <div class="service-icon">📓</div>
                        <div class="service-info">
                            <h3>Notion</h3>
                            <p>Sync tasks and notes with Notion</p>
                        </div>
                    </button>
                    <button class="service-card" data-service="Todoist">
                        <div class="service-icon">✅</div>
                        <div class="service-info">
                            <h3>Todoist</h3>
                            <p>Sync tasks with Todoist</p>
                        </div>
                    </button>
                    <button class="service-card" data-service="Slack">
                        <div class="service-icon">💬</div>
                        <div class="service-info">
                            <h3>Slack</h3>
                            <p>Send notifications to Slack channels</p>
                        </div>
                    </button>
                    <button class="service-card" data-service="Discord">
                        <div class="service-icon">🎮</div>
                        <div class="service-info">
                            <h3>Discord</h3>
                            <p>Send notifications to Discord servers</p>
                        </div>
                    </button>
                    <button class="service-card" data-service="IFTTT">
                        <div class="service-icon">🔗</div>
                        <div class="service-info">
                            <h3>IFTTT</h3>
                            <p>Connect to thousands of services via IFTTT</p>
                        </div>
                    </button>
                    <button class="service-card" data-service="Zapier">
                        <div class="service-icon">⚡</div>
                        <div class="service-info">
                            <h3>Zapier</h3>
                            <p>Automate workflows with Zapier</p>
                        </div>
                    </button>
                    <button class="service-card" data-service="PhilipsHue">
                        <div class="service-icon">💡</div>
                        <div class="service-info">
                            <h3>Philips Hue</h3>
                            <p>Control your smart lighting</p>
                        </div>
                    </button>
                    <button class="service-card" data-service="AppleMusic">
                        <div class="service-icon">🎧</div>
                        <div class="service-info">
                            <h3>Apple Music</h3>
                            <p>Control Apple Music playback</p>
                        </div>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Deck Modal -->
    <div id="deckModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="deckModalTitle">New Deck</h2>
                <button class="modal-close" id="closeDeckModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Deck Name</label>
                    <input type="text" id="deckName" class="input-field" placeholder="Enter deck name" />
                </div>
                <div class="form-group">
                    <label class="form-label">Description</label>
                    <textarea id="deckDescription" class="textarea-field" placeholder="Enter description (optional)" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">Category</label>
                    <select id="deckCategory" class="select-field">
                        <option value="study">Study</option>
                        <option value="work">Work</option>
                        <option value="personal">Personal</option>
                        <option value="other">Other</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancelDeckBtn">Cancel</button>
                <button class="btn btn-primary" id="saveDeckBtn">Save Deck</button>
            </div>
        </div>
    </div>

    <!-- Update Guide Modal -->
    <div id="updateModal" class="modal">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h2 class="modal-title">🔄 Server Update Guide</h2>
                <button class="modal-close" id="closeUpdateModal">&times;</button>
            </div>
            <div class="modal-body" style="max-height: 60vh; overflow-y: auto;">
                <h3 style="color: var(--accent); margin-bottom: 1rem;">Quick Update (Recommended)</h3>
                <p style="margin-bottom: 1rem;">SSH into your server and run this single command:</p>
                <div style="background: var(--bg-tertiary); padding: 1rem; border-radius: 8px; margin-bottom: 2rem; position: relative;">
                    <code style="display: block; color: var(--text-primary); font-size: 13px; line-height: 1.6; word-wrap: break-word;">
cd ~/FocusDeck && \\<br>
git pull origin master && \\<br>
cd src/FocusDeck.Server && \\<br>
dotnet publish FocusDeck.Server.csproj -c Release -r linux-x64 --self-contained -o ~/focusdeck-server && \\<br>
sudo systemctl restart focusdeck
                    </code>
                    <button class="btn btn-secondary btn-small" id="copyUpdateCmd" style="position: absolute; top: 0.5rem; right: 0.5rem;">
                        📋 Copy
                    </button>
                </div>

                <h3 style="color: var(--accent); margin-bottom: 1rem;">Step-by-Step</h3>
                <ol style="padding-left: 1.5rem; line-height: 1.8;">
                    <li><strong>Pull updates:</strong> <code style="background: var(--bg-tertiary); padding: 2px 6px; border-radius: 4px;">cd ~/FocusDeck && git pull</code></li>
                    <li><strong>Rebuild:</strong> <code style="background: var(--bg-tertiary); padding: 2px 6px; border-radius: 4px;">cd src/FocusDeck.Server && dotnet publish ...</code></li>
                    <li><strong>Restart:</strong> <code style="background: var(--bg-tertiary); padding: 2px 6px; border-radius: 4px;">sudo systemctl restart focusdeck</code></li>
                </ol>

                <div style="background: rgba(123, 95, 255, 0.1); border-left: 3px solid var(--accent); padding: 1rem; margin-top: 2rem; border-radius: 4px;">
                    <strong style="color: var(--accent);">💡 Tip:</strong> Clear your browser cache (Ctrl+Shift+Del) after updating to see the new UI!
                </div>

                <div style="margin-top: 2rem; padding: 1rem; background: var(--bg-tertiary); border-radius: 8px;">
                    <h4 style="margin-bottom: 0.5rem;">Need Help?</h4>
                    <p style="font-size: 13px; color: var(--text-secondary); margin-bottom: 0.5rem;">View full documentation:</p>
                    <a href="https://github.com/dertder25t-png/FocusDeck/blob/master/UPDATE_SERVER.md" 
                       target="_blank" 
                       style="color: var(--accent); text-decoration: none;">
                        📖 Complete Update Guide →
                    </a>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="closeUpdateModalBtn">Got It!</button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <!-- Automation History Modal -->
    <div id="automationHistoryModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2 class="modal-title" id="historyModalTitle">Automation History</h2>
                <button class="modal-close" id="closeHistoryModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="stats-grid" style="margin-bottom: 1.5rem;">
                    <div class="stat-box">
                        <div class="stat-label">Total Executions</div>
                        <div class="stat-value" id="historyTotalExecutions">0</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Success Rate</div>
                        <div class="stat-value" id="historySuccessRate" style="color: var(--success);">0%</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Avg Duration</div>
                        <div class="stat-value" id="historyAvgDuration">0ms</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Last Run</div>
                        <div class="stat-value" id="historyLastRun" style="font-size: 0.9rem;">Never</div>
                    </div>
                </div>

                <div class="table-container" style="max-height: 400px; overflow-y: auto;">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Time</th>
                                <th>Status</th>
                                <th>Duration</th>
                                <th>Error</th>
                            </tr>
                        </thead>
                        <tbody id="historyTableBody">
                            <tr>
                                <td colspan="4" style="text-align: center; padding: 2rem; color: var(--text-secondary);">
                                    No execution history yet
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="closeHistoryModalBtn">Close</button>
            </div>
        </div>
    </div>

    <script src="app.js?v=1.1.0"></script>
</body>
</html>

